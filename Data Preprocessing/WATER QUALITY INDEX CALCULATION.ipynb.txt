{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "08e6ff49",
   "metadata": {},
   "source": [
    "WATER QUALITY INDEX(WQI) CALCULATION"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "95fb8525",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ph</th>\n",
       "      <th>Hardness</th>\n",
       "      <th>Solids</th>\n",
       "      <th>Chloramines</th>\n",
       "      <th>Sulfate</th>\n",
       "      <th>Conductivity</th>\n",
       "      <th>Organic_carbon</th>\n",
       "      <th>Trihalomethanes</th>\n",
       "      <th>Turbidity</th>\n",
       "      <th>Potability</th>\n",
       "      <th>nHardness</th>\n",
       "      <th>wph</th>\n",
       "      <th>wHardness</th>\n",
       "      <th>wSolids</th>\n",
       "      <th>wqi</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0.571139</td>\n",
       "      <td>0</td>\n",
       "      <td>7.300212</td>\n",
       "      <td>368.516441</td>\n",
       "      <td>564.308654</td>\n",
       "      <td>10.379783</td>\n",
       "      <td>86.990970</td>\n",
       "      <td>2.963135</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>3.716080</td>\n",
       "      <td>0.297400</td>\n",
       "      <td>0</td>\n",
       "      <td>6.635246</td>\n",
       "      <td>NaN</td>\n",
       "      <td>592.885359</td>\n",
       "      <td>15.180013</td>\n",
       "      <td>56.329076</td>\n",
       "      <td>4.500656</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.613153</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.613153</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>8.099124</td>\n",
       "      <td>0.641311</td>\n",
       "      <td>0</td>\n",
       "      <td>9.275884</td>\n",
       "      <td>NaN</td>\n",
       "      <td>418.606213</td>\n",
       "      <td>16.868637</td>\n",
       "      <td>66.420093</td>\n",
       "      <td>3.055934</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1.336355</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.336355</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>8.316766</td>\n",
       "      <td>0.605536</td>\n",
       "      <td>0</td>\n",
       "      <td>8.059332</td>\n",
       "      <td>356.886136</td>\n",
       "      <td>363.266516</td>\n",
       "      <td>18.436524</td>\n",
       "      <td>100.341674</td>\n",
       "      <td>4.628771</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1.372266</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.372266</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>9.092223</td>\n",
       "      <td>0.484851</td>\n",
       "      <td>0</td>\n",
       "      <td>6.546600</td>\n",
       "      <td>310.135738</td>\n",
       "      <td>398.410813</td>\n",
       "      <td>11.558279</td>\n",
       "      <td>31.997993</td>\n",
       "      <td>4.075075</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1.500217</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.500217</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3271</th>\n",
       "      <td>4.668102</td>\n",
       "      <td>0.530482</td>\n",
       "      <td>0</td>\n",
       "      <td>7.166639</td>\n",
       "      <td>359.948574</td>\n",
       "      <td>526.424171</td>\n",
       "      <td>13.894419</td>\n",
       "      <td>66.687695</td>\n",
       "      <td>4.435821</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0.770237</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.770237</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3272</th>\n",
       "      <td>7.808856</td>\n",
       "      <td>0.530016</td>\n",
       "      <td>0</td>\n",
       "      <td>8.061362</td>\n",
       "      <td>NaN</td>\n",
       "      <td>392.449580</td>\n",
       "      <td>19.903225</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.798243</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1.288461</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.288461</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3273</th>\n",
       "      <td>9.419510</td>\n",
       "      <td>0.465486</td>\n",
       "      <td>0</td>\n",
       "      <td>7.350233</td>\n",
       "      <td>NaN</td>\n",
       "      <td>432.044783</td>\n",
       "      <td>11.039070</td>\n",
       "      <td>69.845400</td>\n",
       "      <td>3.298875</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1.554219</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.554219</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3274</th>\n",
       "      <td>5.126763</td>\n",
       "      <td>0.664407</td>\n",
       "      <td>0</td>\n",
       "      <td>6.303357</td>\n",
       "      <td>NaN</td>\n",
       "      <td>402.883113</td>\n",
       "      <td>11.168946</td>\n",
       "      <td>77.488213</td>\n",
       "      <td>4.708658</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0.845916</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.845916</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3275</th>\n",
       "      <td>7.874671</td>\n",
       "      <td>0.535635</td>\n",
       "      <td>0</td>\n",
       "      <td>7.509306</td>\n",
       "      <td>NaN</td>\n",
       "      <td>327.459760</td>\n",
       "      <td>16.140368</td>\n",
       "      <td>78.698446</td>\n",
       "      <td>2.309149</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1.299321</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.299321</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3276 rows Ã— 15 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            ph  Hardness  Solids  Chloramines     Sulfate  Conductivity  \\\n",
       "0          NaN  0.571139       0     7.300212  368.516441    564.308654   \n",
       "1     3.716080  0.297400       0     6.635246         NaN    592.885359   \n",
       "2     8.099124  0.641311       0     9.275884         NaN    418.606213   \n",
       "3     8.316766  0.605536       0     8.059332  356.886136    363.266516   \n",
       "4     9.092223  0.484851       0     6.546600  310.135738    398.410813   \n",
       "...        ...       ...     ...          ...         ...           ...   \n",
       "3271  4.668102  0.530482       0     7.166639  359.948574    526.424171   \n",
       "3272  7.808856  0.530016       0     8.061362         NaN    392.449580   \n",
       "3273  9.419510  0.465486       0     7.350233         NaN    432.044783   \n",
       "3274  5.126763  0.664407       0     6.303357         NaN    402.883113   \n",
       "3275  7.874671  0.535635       0     7.509306         NaN    327.459760   \n",
       "\n",
       "      Organic_carbon  Trihalomethanes  Turbidity  Potability  nHardness  \\\n",
       "0          10.379783        86.990970   2.963135           0          0   \n",
       "1          15.180013        56.329076   4.500656           0          0   \n",
       "2          16.868637        66.420093   3.055934           0          0   \n",
       "3          18.436524       100.341674   4.628771           0          0   \n",
       "4          11.558279        31.997993   4.075075           0          0   \n",
       "...              ...              ...        ...         ...        ...   \n",
       "3271       13.894419        66.687695   4.435821           1          0   \n",
       "3272       19.903225              NaN   2.798243           1          0   \n",
       "3273       11.039070        69.845400   3.298875           1          0   \n",
       "3274       11.168946        77.488213   4.708658           1          0   \n",
       "3275       16.140368        78.698446   2.309149           1          0   \n",
       "\n",
       "           wph  wHardness  wSolids       wqi  \n",
       "0          NaN        0.0      0.0       NaN  \n",
       "1     0.613153        0.0      0.0  0.613153  \n",
       "2     1.336355        0.0      0.0  1.336355  \n",
       "3     1.372266        0.0      0.0  1.372266  \n",
       "4     1.500217        0.0      0.0  1.500217  \n",
       "...        ...        ...      ...       ...  \n",
       "3271  0.770237        0.0      0.0  0.770237  \n",
       "3272  1.288461        0.0      0.0  1.288461  \n",
       "3273  1.554219        0.0      0.0  1.554219  \n",
       "3274  0.845916        0.0      0.0  0.845916  \n",
       "3275  1.299321        0.0      0.0  1.299321  \n",
       "\n",
       "[3276 rows x 15 columns]"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['wph']=df.ph*0.165\n",
    "df['wHardness']=df.nHardness*0.281\n",
    "df['wSolids']=df.Solids*0.281\n",
    "df['wqi']=df.wph+df.wHardness+df.wSolids\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "dba2aa29",
   "metadata": {},
   "outputs": [],
   "source": [
    "average=df.groupby('Potability')['wqi'].mean()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
